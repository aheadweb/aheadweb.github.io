!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);function o(t,e,n){n.target.value.length>1?t.classList.add(e):t.classList.remove(e)}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.body=e,this.baseOpenClass="select_open",this.baseJsInputClass="js-select-input",this.input=this.body.querySelector(".".concat(this.baseJsInputClass)),this.baseJsPlaceholderClass="js-select-title",this.placeholder=this.body.querySelector(".".concat(this.baseJsPlaceholderClass)),this.baseJsListCLass="js-select-list",this.init()}var e,n,o;return e=t,(n=[{key:"init",value:function(){this.body?(this.bindClickSelect(),this.bindGlobalClose()):console.error("Can't init select on ".concat(this.node,"! Probably is not htmlElement"))}},{key:"bindGlobalClose",value:function(){var t=this;document.addEventListener("click",(function(e){e.target.closest(".js-select")||t.closeSelect()}))}},{key:"bindClickSelect",value:function(){var t=this;this.body.addEventListener("click",(function(e){var n=e.target;n.classList.contains(t.baseJsPlaceholderClass)?t.body.classList.contains(t.baseOpenClass)?t.closeSelect():t.openSelect():n.closest(".".concat(t.baseJsListCLass))&&t.onItemClick(n)}))}},{key:"openSelect",value:function(){this.body.classList.add(this.baseOpenClass)}},{key:"closeSelect",value:function(){this.body.classList.remove(this.baseOpenClass)}},{key:"onItemClick",value:function(t){var e=t.dataset.value;e&&(this.setValueOnInput(e),this.setTitleText(t.textContent),this.closeSelect())}},{key:"setTitleText",value:function(t){this.placeholder.textContent=t}},{key:"setValueOnInput",value:function(t){this.input.value=t}}])&&i(e.prototype,n),o&&i(e,o),t}();function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(a,t);var e,n,o,i=f(a);function a(t){var e,n=t.body,o=t.fetchUrl;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this)).baseJsClass=n,e.fetchUrl=o,e.baseBodyClass="".concat(e.baseJsClass,"-body"),e.baseJsDeleteClass="".concat(e.baseJsClass,"-delete-row"),e.baseJSRowClass="".concat(e.baseJsClass,"-row"),e.table=document.querySelector(e.baseJsClass),e.body=e.table.querySelector(e.baseBodyClass),e.statusEnum={pednding:"Ожидается",out_of_stock:"Нет в наличии",in_stock:"В наличии"},e}return e=a,(n=[{key:"init",value:function(){null!==this.body?(console.info("Table component init"),this.globalBindDeleteRow(),this.toggleStatusloading(!0),this.fetchData()):console.warn("Can't init table component. Not found ".concat(this.baseJsClass))}},{key:"globalBindDeleteRow",value:function(){var t=this;document.addEventListener("click",(function(e){var n=e.target;n.classList.contains(t.baseJsDeleteClass.slice(1))&&n.closest(t.baseJSRowClass).remove()}))}},{key:"toggleStatusloading",value:function(t){var e=t?"add":"remove";this.table.classList[e]("table_loading")}},{key:"fetchData",value:function(){l(b(a.prototype),"makeRequest",this).call(this,this.fetchUrl).then(this.renderTable.bind(this))}},{key:"renderTable",value:function(t){var e=this,n=t.map(this.getHtmlRowWithData.bind(this)).join("");setTimeout((function(){e.body.innerHTML=n,e.toggleStatusloading(!1)}),2e3)}},{key:"dispatch",value:function(t,e){if("SET_NEW_ROW"===t){this.toggleStatusloading(!0);var n=this.getHtmlRowWithData(e);this.body.innerHTML=this.body.innerHTML+n,this.toggleStatusloading(!1)}}},{key:"getHtmlRowWithData",value:function(t){var e=t.title,n=t.id,o=t.color,i=t.description,a=t.price,s=t.status,r=t.year,c=""===i?"table__col_empty":"";return'\n        <div class="table__row js-table-row" data-id='.concat(n,'>\n            <div class="table__col">').concat(e,'</div>\n            <div class="table__col">').concat(r,'</div>\n            <div class="table__col">\n              <div class="color-circle" data-color="').concat(o,'"></div>\n            </div>\n            <div class="table__col">').concat(this.statusEnum[s],'</div>\n            <div class="table__col">').concat(a,' руб.</div>\n            <div class="table__col">\n              <button class="btn btn_delete js-table-delete-row">Удалить</button>\n            </div>\n            <div class="table__col ').concat(c,'"><span class="table__col-descr">').concat(i,"</span></div>\n        </div>\n      ")}}])&&c(e.prototype,n),o&&c(e,o),a}(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"makeRequest",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,o){fetch(t,e).then((function(t){return t.json()})).then(n).catch(o)}))}}])&&s(e.prototype,n),o&&s(e,o),t}());function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var v=function(){function t(e){var n=e.body,o=e.sendEvent;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.body=document.querySelector(n),this.form=this.body.querySelector(".js-main-form"),this.btnSend=this.body.querySelector(".js-main-btn-send"),this.sendMyEvent=o,this.enumFormFields={title:"Название",year:"Год",color:"Цвет",status:"Статус",price:"Цена",description:"Описание"}}var e,n,o;return e=t,(n=[{key:"init",value:function(){null!==this.body?(this.btnSend.addEventListener("click",this.sendForm.bind(this)),console.log("MainPage init")):console.warn("Can't init mainPage component. Not found main htmlElment")}},{key:"sendForm",value:function(t){var e=this,n=t.target,o=!1,i=n.closest(".js-main-form"),a=new FormData(i),s={};a.forEach((function(t,n){""===t&&(alert("Поле '".concat(e.enumFormFields[n],"' пустое/ не выбранное")),o=!0),s[n]=t})),s.color||(alert("Поле '".concat(this.enumFormFields.color,"' пустое/ не выбранное")),o=!0),o||(s.id=Date.now(),this.sendMyEvent({type:"SET_NEW_ROW",payload:s}),this.resetFields())}},{key:"resetFields",value:function(){this.form.querySelectorAll("input:not([type='radio'])").forEach((function(t){t.value=""}))}}])&&y(e.prototype,n),o&&y(e,o),t}();function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var m=function(){function t(e){var n=e.dependency,o=e.components,i=void 0===o?[]:o,a=e.modules,s=void 0===a?[]:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.components=i,this.modules=s,n(),this.init()}var e,n,o;return e=t,(n=[{key:"init",value:function(){this.components.forEach((function(t){t.init&&t.init()})),this.modules.forEach((function(t){t.init&&t.init()})),console.info("App init")}},{key:"sendEvent",value:function(t){var e=t.type,n=t.payload;switch(e){case"SET_NEW_ROW":this.components.forEach((function(t){".js-table"===t.baseJsClass&&t.dispatch(e,n)}))}}}])&&p(e.prototype,n),o&&p(e,o),t}();window.addEventListener("load",(function(){var t=new m({components:[new h({body:".js-table",fetchUrl:"https://rawgit.com/Varinetz/e6cbadec972e76a340c41a65fcc2a6b3/raw/90191826a3bac2ff0761040ed1d95c59f14eaf26/frontend_test_table.json"})],modules:[new v({body:".js-main",sendEvent:function(e){return t.sendEvent(e)}})],dependency:function(){var t,e,n;e=".js-".concat(t="field"),n="".concat(t,"_focus"),(document.querySelectorAll(e)||[]).forEach((function(t){var e=t.querySelector("input");e&&(e.addEventListener("focus",(function(){return t.classList.add(n)})),e.addEventListener("blur",o.bind(void 0,t,n)))})),document.querySelectorAll(".js-select").forEach((function(t){return new a(t)}))}})}))}]);